### Nginx

**1.定义**

​		Nginx是一款轻量级的Web服务器、反向代理服务器，由于它的内存占用少，启动极快，高并发能力强，在互联网项目中广泛应用。使用C开发。官方称可以单节点可以支持5W并发连接数，实际生产环境可以承受2~3万并发。

**2.架构**

​		有一个`master`进程，读取并且验证nginx.conf+管理多个worker进程；

​		多个`worker`进程，在内部都会维护一个处理连接和请求的线程。

**3.热部署**

- [ ] master更新->提交worker更新

- [x] master更新->worker换代升级

4.优点

- 动静分离：将网站静态资源（网页HTML、img、CSS）与后台应用分开，提高用户访问静态资源的速度，降低对后台的访问。
- 反向代理：保障服务器的安全，实现负载均衡，实现IP访问控制。
- 健康检查：max_fials和failout_time

5.主要命令

`./nginx -s stop`+`./nginx -s quit`+`./nginx -s reload`

6.一致性哈希

- 应用背景：普通哈希需要扩容增加服务节点时会导致原有哈希映射大面积失效，导致整个服务无法平滑地扩容。

- 内涵解释：普通取模哈希算法的改良版，哈希函数的计算方法不变，然后通过构建环状的hash空间代替普通的线性空间。

- 过程步骤：

  > 1.通过服务器IP或者主机名计算得到哈希值，就是该服务节点在hash环上的位置。
  >
  > 2.计算数据的哈希值，并从这个位置顺时针行走遇到的第一台服务器就是它定位到的服务器。

  所以一致性哈希在某个服务器宕机或者新增一台服务器的时候，只有该服务器到其前一台服务器之前的数据收到影响。因此具有较好的容错性和可拓展性。

- 虚拟节点机制：对于每个服务节点计算多次哈希，其他的都不变，只是多了一步虚拟节点到实际节点的映射过程。





额外知识：

windows为读写文件提供了异步接口，Linux异步IO